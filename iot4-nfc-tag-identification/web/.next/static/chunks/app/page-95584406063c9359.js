(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{6208:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var r=s(5155),n=s(2115);let c=s(5704).env.NEXT_PUBLIC_WS_URL||"ws://localhost:5000/ws/scan";function l(e){let{className:t}=e;return(0,r.jsxs)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("path",{d:"M6 8.32a7.43 7.43 0 0 1 0 7.36"}),(0,r.jsx)("path",{d:"M9.46 6.21a11.76 11.76 0 0 1 0 11.58"}),(0,r.jsx)("path",{d:"M12.91 4.1a15.91 15.91 0 0 1 .01 15.8"}),(0,r.jsx)("path",{d:"M16.37 2a20.16 20.16 0 0 1 0 20"})]})}function a(){return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen animate-fade-in",children:[(0,r.jsxs)("div",{className:"relative mb-12",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-kiosk-accent/20 rounded-full animate-pulse-ring"}),(0,r.jsx)("div",{className:"relative bg-kiosk-accent/10 rounded-full p-12",children:(0,r.jsx)(l,{className:"w-32 h-32 text-kiosk-accent"})})]}),(0,r.jsx)("h1",{className:"text-5xl font-bold mb-4 text-center",children:"Tap Your Card"}),(0,r.jsx)("p",{className:"text-2xl text-gray-400 text-center",children:"Place your student card on the reader to verify"}),(0,r.jsx)("div",{className:"absolute bottom-8 text-gray-500 text-xl",children:(0,r.jsx)(o,{})})]})}function o(){let[e,t]=(0,n.useState)("");return(0,n.useEffect)(()=>{let e=()=>{t(new Date().toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}))};e();let s=setInterval(e,1e3);return()=>clearInterval(s)},[]),(0,r.jsx)("span",{children:e})}function i(){return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen animate-fade-in",children:[(0,r.jsx)("div",{className:"relative mb-12",children:(0,r.jsx)("div",{className:"w-32 h-32 border-4 border-gray-700 border-t-kiosk-accent rounded-full animate-spin"})}),(0,r.jsx)("h1",{className:"text-5xl font-bold mb-4",children:"Verifying..."}),(0,r.jsx)("p",{className:"text-2xl text-gray-400",children:"Please wait"})]})}function d(e){let{className:t}=e;return(0,r.jsx)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:(0,r.jsx)("path",{d:"M20 6L9 17l-5-5",strokeLinecap:"round",strokeLinejoin:"round"})})}function u(e){let{className:t}=e;return(0,r.jsx)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:(0,r.jsx)("path",{d:"M18 6L6 18M6 6l12 12",strokeLinecap:"round",strokeLinejoin:"round"})})}function x(e){let{result:t}=e,s=!0===t.verified;return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen animate-fade-in",children:[(0,r.jsx)("div",{className:"rounded-full p-8 mb-8 ".concat(s?"bg-kiosk-success/20":"bg-kiosk-error/20"),children:s?(0,r.jsx)(d,{className:"w-24 h-24 text-kiosk-success"}):(0,r.jsx)(u,{className:"w-24 h-24 text-kiosk-error"})}),(0,r.jsx)("div",{className:"px-6 py-2 rounded-full text-2xl font-bold mb-8 ".concat(s?"bg-kiosk-success text-white":"bg-kiosk-error text-white"),children:s?"VERIFIED":"VERIFICATION FAILED"}),s?(0,r.jsxs)("div",{className:"text-center space-y-4",children:[(0,r.jsx)("h1",{className:"text-6xl font-bold",children:t.student_name}),(0,r.jsxs)("div",{className:"text-3xl text-gray-300",children:["ID: ",t.student_id]}),(0,r.jsx)("div",{className:"text-2xl text-gray-400",children:t.department})]}):(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("p",{className:"text-3xl text-gray-300",children:t.error||"Unknown error"})})]})}function m(e){let{status:t}=e,s={connected:{color:"bg-kiosk-success",text:"Connected"},connecting:{color:"bg-yellow-500",text:"Connecting..."},disconnected:{color:"bg-kiosk-error",text:"Disconnected"}}[t];return(0,r.jsxs)("div",{className:"fixed top-4 right-4 flex items-center gap-2 bg-gray-800/50 px-4 py-2 rounded-full",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(s.color)}),(0,r.jsx)("span",{className:"text-sm text-gray-300",children:s.text})]})}function h(){let{status:e,lastScan:t}=function(){let[e,t]=(0,n.useState)("connecting"),[s,r]=(0,n.useState)(null),l=(0,n.useRef)(null),a=(0,n.useRef)(null),o=(0,n.useCallback)(()=>{var e;if((null==(e=l.current)?void 0:e.readyState)!==WebSocket.OPEN){t("connecting");try{let e=new WebSocket(c);l.current=e,e.onopen=()=>{t("connected"),console.log("WebSocket connected")},e.onmessage=e=>{try{let t=JSON.parse(e.data);"scan"===t.event&&r(t)}catch(e){console.error("Failed to parse WebSocket message:",e)}},e.onclose=()=>{t("disconnected"),console.log("WebSocket disconnected, reconnecting..."),i()},e.onerror=t=>{console.error("WebSocket error:",t),e.close()}}catch(e){console.error("Failed to create WebSocket:",e),t("disconnected"),i()}}},[]),i=(0,n.useCallback)(()=>{a.current&&clearTimeout(a.current),a.current=setTimeout(()=>{o()},3e3)},[o]),d=(0,n.useCallback)(()=>{var e;null==(e=l.current)||e.close(),o()},[o]);return(0,n.useEffect)(()=>(o(),()=>{var e;a.current&&clearTimeout(a.current),null==(e=l.current)||e.close()}),[o]),{status:e,lastScan:s,reconnect:d}}(),[s,l]=(0,n.useState)("idle"),[o,d]=(0,n.useState)(null),[u,h]=(0,n.useState)(null);return(0,n.useEffect)(()=>{if(!t||t.timestamp===u)return;h(t.timestamp),l("verifying");let e=setTimeout(()=>{d(t),l("result");let e=setTimeout(()=>{l("idle"),d(null)},t.verified?5e3:3e3);return()=>clearTimeout(e)},400);return()=>clearTimeout(e)},[t,u]),(0,r.jsxs)("main",{className:"relative",children:[(0,r.jsx)(m,{status:e}),"idle"===s&&(0,r.jsx)(a,{}),"verifying"===s&&(0,r.jsx)(i,{}),"result"===s&&o&&(0,r.jsx)(x,{result:o})]})}},7181:(e,t,s)=>{Promise.resolve().then(s.bind(s,6208))}},e=>{e.O(0,[441,255,358],()=>e(e.s=7181)),_N_E=e.O()}]);